@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@using Fr.EQL.Ai109.Tontapatt.Model
@model DemandeDeReservationDetails
@{
    #region CONDITION BOUTON POINTAGE JOURNALIER
    bool btnPointageJournalierDisabled = true;
    string messageBoutonPointageJournalier;
    string btnPointageJournalierDisabledClass = "";
    if (Model.DateInstallationTroupeau.HasValue && DateTime.Compare(Model.DateInstallationTroupeau.Value, DateTime.Today) < 0)
    {
        btnPointageJournalierDisabled = false;
        messageBoutonPointageJournalier = "Pointage Journalier";
        btnPointageJournalierDisabledClass = "";
    }
    else
    {
        btnPointageJournalierDisabled = true;
        messageBoutonPointageJournalier = "Vous ne pouvez pas accéder à la liste de pointage si le troupeau n'est pas encore installé";
        btnPointageJournalierDisabledClass = "btn-disabled";
    }
    #endregion

    #region CONDITION BOUTON DECLARATION ANOMALIE
    bool btnDeclarerAnomalieDisabled = false;
    string messageBoutonDeclarerAnomalie = "Declarer une Anomalie";
    string btnDeclarerAnomalieDisabledClass = "";
    #endregion

    #region CONDITION BOUTON DECLARATION ANOMALIE
    bool btnListeAnomalieDisabled = false;
    string messageBoutonListeAnomalie = "Liste Anomalies";
    string btnListeAnomalieDisabledClass = "";
    #endregion

    #region CONDITION BOUTON TERMIER
    string btnTerminerDisabledClass = "";
    bool btnTerminerDisabled = true;
    string messageBoutonTerminer;
    if (DateTime.Compare(Model.DateFinDemande, DateTime.Today) > 0)
    {
        btnTerminerDisabled = true;
        messageBoutonTerminer = "Vous ne pouvez pas terminer la prestation avant sa date de fin";
        btnTerminerDisabledClass = "btn-disabled";
    }
    else if (Model.DateAcceptationDemande is null)
    {
        btnTerminerDisabled = true;
        messageBoutonTerminer = "Vous ne pouvez pas terminer une prestation si elle n'est pas acceptée";
        btnTerminerDisabledClass = "btn-disabled";
    }
    else if (Model.DateInstallationTroupeau is null)
    {
        btnTerminerDisabled = true;
        messageBoutonTerminer = "Le troupeau n'a pas été installé. Prestation non effectuée";
        btnTerminerDisabledClass = "btn-disabled";
    }
    else
    {
        btnTerminerDisabled = false;
        messageBoutonTerminer = "Terminer la Prestation";
        btnTerminerDisabledClass = "";
    }
    #endregion
}
<div class="infosOffre_main">
    <h2 class="infosOffre_h1">Votre prestation Actuelle numéro @Model.NumeroReservation</h2>

    <h3 class="infosOffre_h1"> Offre : @Model.OffreDeTonteDetails.NomOffre</h3>
    <div class="infosOffre_div">
        <div class="infosOffre_infos">
            <p class="infosOffre_infosNomUtilisateur"><strong>Nom de l'éleveur : <a href="#">@Model.OffreDeTonteDetails.NomUtilisateur @Model.OffreDeTonteDetails.PrenomUtilisateur</a></strong></p>
            <p class="infosOffre_infosDescription"><strong>Description de l'offre' : </strong>@Model.OffreDeTonteDetails.DescriptionOffre</p>
            <span class="separator-fin-prestation"></span>
            <p class="infosOffre_infosDateDebut"><strong>Date de début de la prestation : </strong>@Model.DateDebutDemande.ToString("dd/MM/yyyy")</p>
            <p class="infosOffre_infosDateFin"><strong>Date de fin de la prestation : </strong> @Model.DateFinDemande.ToString("dd/MM/yyyy")</p>
            <p class="infosOffre_infosDateAcceptation">
                <strong>Date de l'acceptation : </strong>
                @if (Model.DateAcceptationDemande.HasValue)
                {
                    @Model.DateAcceptationDemande.Value.ToString("dd/MM/yyyy");
                }
                else
                {
                    <span>La demande n'est pas encore acceptée</span>
                }
            </p>
            <p class="infosOffre_infosDateInstallationTroupeau">
                <strong>Date de l'installation du tropeau : </strong>
                @if (Model.DateInstallationTroupeau.HasValue)
                {
                    @Model.DateInstallationTroupeau.Value.ToString("dd/MM/yyyy");
                }
                else if (!Model.DateAcceptationDemande.HasValue)
                {
                    <span>La demande n'est pas encore acceptée</span>
                }
                else
                {
                    <span>Le troupeau n'est pas encore installé</span>
                }
            </p>
            <span class="separator-fin-prestation"></span>
            <p class="infosOffre_infosDistance"><strong>Distance : </strong>@Model.OffreDeTonteDetails.DistanceOffreDeTonteTerrain km </p>
            <p class="infosOffre_infosNomVille"><strong>Ville / Code Postal : </strong>@Model.OffreDeTonteDetails.NomVilleOfrreDeTonte. / @Model.OffreDeTonteDetails.CodePostaleOffreDeTonte</p>
            <span class="separator-fin-prestation"></span>
            <p class="infosOffre_infosEspeceAnimal"><strong>Espece d'animal : </strong>@Model.OffreDeTonteDetails.EspeceAnimal</p>
            <p class="infosOffre_infosRaceAnimal"><strong>Race d'animal : </strong>@Model.OffreDeTonteDetails.RaceAnimal</p>
            <p class="infosOffre_infosNombreAnimal"><strong>Nombres d'animaux : </strong>@Model.NombreAnimaux</p>
            <span class="separator-fin-prestation"></span>
            <p class="infosOffre_infosPrix"><strong>Coût par jour par animal: </strong>@Model.OffreDeTonteDetails.CoutAnimalParJour</p>
        </div>

        <div class="infosOffre_selection ">

            @if (ViewBag.Classe == 1)
            {
                <div class="btn-prestation-details-right">
                    <input class="btn-light @btnPointageJournalierDisabledClass" title="@messageBoutonPointageJournalier" type="button" value="Pointage Journalier" onclick="location.href='@Url.Action("PointageJournalierClient", "Utilisateur", new {idDemandeDeReservation=@Model.IdDemande, idUtilisateur=@Model.TerrainDetails.IdUtilisateur, idClasse=@ViewBag.Classe})'" disabled="@btnPointageJournalierDisabled" />
                </div>
                <div class="btn-prestation-details-right">
                    <input class="btn-light @btnDeclarerAnomalieDisabledClass" title="@messageBoutonDeclarerAnomalie" type="button" value="Déclarer une Anomalie" onclick="location.href='@Url.Action("DeclarationAnomalieClient", "Utilisateur", new {idDemandeDeReservation=@Model.IdDemande, idUtilisateur=@Model.TerrainDetails.IdUtilisateur, idClasse=@ViewBag.Classe})'" disabled="@btnDeclarerAnomalieDisabled" />
                </div>
                <div class="btn-prestation-details-right">
                    <input class="btn-light @btnListeAnomalieDisabledClass" title="@messageBoutonListeAnomalie" type="button" value="Liste Anomalies" onclick="location.href='@Url.Action("ListeAnomalie", "Utilisateur", new {idDemandeDeReservation=@Model.IdDemande, idUtilisateur=@Model.TerrainDetails.IdUtilisateur, idClasse=@ViewBag.Classe})'" disabled="@btnListeAnomalieDisabled" />
                </div>
                <div class="btn-prestation-details-right">
                    <input class="btn-light @btnTerminerDisabledClass" title="@messageBoutonTerminer" type="button" value="Terminer" onclick="location.href='@Url.Action("FinPrestation", "Utilisateur", new {idDemandeDeReservation=@Model.IdDemande, idUtilisateur=@Model.TerrainDetails.IdUtilisateur, idClasse=@ViewBag.Classe})'" disabled="@btnTerminerDisabled" />
                </div>
            }
            else if (ViewBag.Classe == 0)
            {
                <div>
                    <a class="btn-light" asp-controller="Utilisateur" asp-action="AnnulationAvantAcceptation" asp-route-idDemandeDeReservation="@Model.IdDemande" asp-route-idUtilisateur="@Model.TerrainDetails.IdUtilisateur" asp-route-idClasse="@ViewBag.Classe">Annuler la réservation</a>
                </div>
            }
            else if(ViewBag.Classe == 2)
            {
                <div class="btn-prestation-details-right">
                    <input class="btn-light @btnPointageJournalierDisabledClass" title="@messageBoutonPointageJournalier" type="button" value="Pointage Journalier" onclick="location.href='@Url.Action("PointageJournalierEleveur", "Utilisateur", new {idDemandeDeReservation=@Model.IdDemande, idUtilisateur=@Model.OffreDeTonteDetails.IdUtilisateur, idClasse=@ViewBag.Classe})'" disabled="@btnPointageJournalierDisabled" />
                </div>
                <div class="btn-prestation-details-right">
                    <input class="btn-light @btnListeAnomalieDisabledClass" title="@messageBoutonListeAnomalie" type="button" value="Liste Anomalies" onclick="location.href='@Url.Action("ListeAnomalie", "Utilisateur", new {idDemandeDeReservation=@Model.IdDemande, idUtilisateur=@Model.OffreDeTonteDetails.IdUtilisateur, idClasse=@ViewBag.Classe})'" disabled="@btnListeAnomalieDisabled" />
                </div>
                <div class="btn-prestation-details-right">
                    <input class="btn-light @btnTerminerDisabledClass" title="@messageBoutonTerminer" type="button" value="Evaluations" onclick="location.href='@Url.Action("AfficherEvaluationPrestation", "Utilisateur", new {idDemandeDeReservation=@Model.IdDemande, idUtilisateur=@ViewBag.IdUtilisateur, idClasse=@ViewBag.Classe})'" disabled="@btnTerminerDisabled" />
                </div>
            }
        </div>
    </div>
</div>